{% extends 'base.html' %}

{% block title %}üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î{% endblock %}

{% block content %}
<div class="w-full pr-4 lg:pr-6 xl:pr-8 py-8">
  <h2 class="text-2xl font-semibold mb-6">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>

  <div class="overflow-x-auto">
    <table class="table-auto w-full bg-white rounded-lg shadow-md border border-gray-200">
      <thead class="bg-gray-100 text-gray-700">
        <tr>
          <th class="px-4 py-2 text-left">‡∏£‡∏´‡∏±‡∏™‡∏á‡∏≤‡∏ô</th>
          <th class="px-4 py-2 text-left">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
          <th class="px-4 py-2 text-left">‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</th>
          <th class="px-4 py-2 text-left">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</th>
          <th class="px-4 py-2 text-left">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</th>
          <th class="px-4 py-2 text-left">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á</th>
          <th class="px-4 py-2 text-left">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</th>
          <th class="px-4 py-2 text-left">‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
        </tr>
      </thead>
      <tbody>
        {% for request in request_list %}
        <tr class="border-t hover:bg-gray-50">
          <td class="px-4 py-2 font-mono text-sm">{{ request.taskCode }}</td>

          <td class="px-4 py-2">
            <select class="editable-input" data-task="{{ request.taskCode }}" data-field="status">
              <option value="‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô" {% if request.status == '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô' %}selected{% endif %}>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</option>
              <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£" {% if request.status == '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' %}selected{% endif %}>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
              <option value="‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô" {% if request.status == '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô' %}selected{% endif %}>‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</option>
            </select>
          </td>

          <td class="px-4 py-2">
            <input type="text" value="{{ request.title }}" class="editable-input" data-task="{{ request.taskCode }}" data-field="title">
          </td>

          <td class="px-4 py-2">
            <select class="editable-input" data-task="{{ request.taskCode }}" data-field="priority">
              <option value="‡∏™‡∏π‡∏á" {% if request.priority == '‡∏™‡∏π‡∏á' %}selected{% endif %}>‡∏™‡∏π‡∏á</option>
              <option value="‡∏Å‡∏•‡∏≤‡∏á" {% if request.priority == '‡∏Å‡∏•‡∏≤‡∏á' %}selected{% endif %}>‡∏Å‡∏•‡∏≤‡∏á</option>
              <option value="‡∏ï‡πà‡∏≥" {% if request.priority == '‡∏ï‡πà‡∏≥' %}selected{% endif %}>‡∏ï‡πà‡∏≥</option>
            </select>
          </td>

          <td class="px-4 py-2">
            <select class="editable-input" data-task="{{ request.taskCode }}" data-field="type">
              <option value="Project" {% if request.type == 'Project' %}selected{% endif %}>Project</option>
              <option value="Dashboard" {% if request.type == 'Dashboard' %}selected{% endif %}>Dashboard</option>
              <option value="Report" {% if request.type == 'Report' %}selected{% endif %}>Report</option>
              <option value="Data" {% if request.type == 'Data' %}selected{% endif %}>Data</option>
              <option value="Support" {% if request.type == 'Support' %}selected{% endif %}>Support</option>
            </select>
          </td>

          <td class="px-4 py-2 text-sm text-gray-600">{{ request.createdAt | format_date }}</td>

          <td class="px-4 py-2">
            <input type="date" value="{{ request.sendDate }}" class="editable-input" data-task="{{ request.taskCode }}" data-field="sendDate">
          </td>

          <td class="px-4 py-2">
            <button class="px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition"
                    onclick="saveRow('{{ request.taskCode }}')">
              ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
            </button>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<script type="module">
  import { saveRow } from '/app/static/status.js';
  window.saveRow = saveRow;
</script>

{% endblock %}
